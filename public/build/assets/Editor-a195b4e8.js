import{v as d}from"./app-37deda0f.js";var B=["onActivate","onAddUndo","onBeforeAddUndo","onBeforeExecCommand","onBeforeGetContent","onBeforeRenderUI","onBeforeSetContent","onBeforePaste","onBlur","onChange","onClearUndos","onClick","onContextMenu","onCopy","onCut","onDblclick","onDeactivate","onDirty","onDrag","onDragDrop","onDragEnd","onDragGesture","onDragOver","onDrop","onExecCommand","onFocus","onFocusIn","onFocusOut","onGetContent","onHide","onInit","onKeyDown","onKeyPress","onKeyUp","onLoadContent","onMouseDown","onMouseEnter","onMouseLeave","onMouseMove","onMouseOut","onMouseOver","onMouseUp","onNodeChange","onObjectResizeStart","onObjectResized","onObjectSelected","onPaste","onPostProcess","onPostRender","onPreProcess","onProgressState","onRedo","onRemove","onReset","onSaveContent","onSelectionChange","onSetAttrib","onSetContent","onShow","onSubmit","onUndo","onVisualAid"],I=function(n){return B.map(function(t){return t.toLowerCase()}).indexOf(n.toLowerCase())!==-1},L=function(n,t,e){Object.keys(t).filter(I).forEach(function(o){var i=t[o];typeof i=="function"&&(o==="onInit"?i(n,e):e.on(o.substring(2),function(a){return i(a,e)}))})},V=function(n,t,e,o){var i=n.modelEvents?n.modelEvents:null,a=Array.isArray(i)?i.join(" "):i;d.watch(o,function(f,c){e&&typeof f=="string"&&f!==c&&f!==e.getContent({format:n.outputFormat})&&e.setContent(f)}),e.on(a||"change input undo redo",function(){t.emit("update:modelValue",e.getContent({format:n.outputFormat}))})},j=function(n,t,e,o,i,a){o.setContent(a()),e.attrs["onUpdate:modelValue"]&&V(t,e,o,i),L(n,e.attrs,o)},E=0,D=function(n){var t=Date.now(),e=Math.floor(Math.random()*1e9);return E++,n+"_"+e+E+String(t)},U=function(n){return n!==null&&n.tagName.toLowerCase()==="textarea"},p=function(n){return typeof n>"u"||n===""?[]:Array.isArray(n)?n:n.split(" ")},_=function(n,t){return p(n).concat(p(t))},x=function(n){return n==null},w=function(){return{listeners:[],scriptId:D("tiny-script"),scriptLoaded:!1}},R=function(){var n=w(),t=function(i,a,f,c){var r=a.createElement("script");r.referrerPolicy="origin",r.type="application/javascript",r.id=i,r.src=f;var m=function(){r.removeEventListener("load",m),c()};r.addEventListener("load",m),a.head&&a.head.appendChild(r)},e=function(i,a,f){n.scriptLoaded?f():(n.listeners.push(f),i.getElementById(n.scriptId)||t(n.scriptId,i,a,function(){n.listeners.forEach(function(c){return c()}),n.scriptLoaded=!0}))},o=function(){n=w()};return{load:e,reinitialize:o}},T=R(),K=function(){return typeof window<"u"?window:global},v=function(){var n=K();return n&&n.tinymce?n.tinymce:null},z={apiKey:String,cloudChannel:String,id:String,init:Object,initialValue:String,inline:Boolean,modelEvents:[String,Array],plugins:[String,Array],tagName:String,toolbar:[String,Array],modelValue:String,disabled:Boolean,tinymceScriptSrc:String,outputFormat:{type:String,validator:function(n){return n==="html"||n==="text"}}},s=globalThis&&globalThis.__assign||function(){return s=Object.assign||function(n){for(var t,e=1,o=arguments.length;e<o;e++){t=arguments[e];for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])}return n},s.apply(this,arguments)},F=function(n,t,e,o){return n(o||"div",{id:t,ref:e})},N=function(n,t,e){return n("textarea",{id:t,visibility:"hidden",ref:e})},k=d.defineComponent({props:z,setup:function(n,t){var e=n.init?s({},n.init):{},o=d.toRefs(n),i=o.disabled,a=o.modelValue,f=o.tagName,c=d.ref(null),r=null,m=n.id||D("tiny-vue"),h=n.init&&n.init.inline||n.inline,S=!!t.attrs["onUpdate:modelValue"],b=!0,A=n.initialValue?n.initialValue:"",C="",M=function(u){return S?function(){return a!=null&&a.value?a.value:""}:function(){return u?A:C}},y=function(){var u=M(b),l=s(s({},e),{readonly:n.disabled,selector:"#"+m,plugins:_(e.plugins,n.plugins),toolbar:n.toolbar||e.toolbar,inline:h,setup:function(g){r=g,g.on("init",function(P){return j(P,n,t,g,a,u)}),typeof e.setup=="function"&&e.setup(g)}});U(c.value)&&(c.value.style.visibility=""),v().init(l),b=!1};d.watch(i,function(u){var l;r!==null&&(typeof((l=r.mode)===null||l===void 0?void 0:l.set)=="function"?r.mode.set(u?"readonly":"design"):r.setMode(u?"readonly":"design"))}),d.watch(f,function(u){var l;S||(C=r.getContent()),(l=v())===null||l===void 0||l.remove(r),d.nextTick(function(){return y()})}),d.onMounted(function(){if(v()!==null)y();else if(c.value&&c.value.ownerDocument){var u=n.cloudChannel?n.cloudChannel:"5",l=n.apiKey?n.apiKey:"no-api-key",g=x(n.tinymceScriptSrc)?"https://cdn.tiny.cloud/1/"+l+"/tinymce/"+u+"/tinymce.min.js":n.tinymceScriptSrc;T.load(c.value.ownerDocument,g,y)}}),d.onBeforeUnmount(function(){v()!==null&&v().remove(r)}),h||(d.onActivated(function(){b||y()}),d.onDeactivated(function(){var u;S||(C=r.getContent()),(u=v())===null||u===void 0||u.remove(r)}));var O=function(u){var l;C=r.getContent(),(l=v())===null||l===void 0||l.remove(r),e=s(s({},e),u),d.nextTick(function(){return y()})};return t.expose({rerender:O}),function(){return h?F(d.h,m,c,n.tagName):N(d.h,m,c)}}});export{k as E};
